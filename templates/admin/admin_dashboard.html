<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- External Libraries -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" href="https://res.cloudinary.com/dl2ipzxyk/image/upload/v1751107241/logo_ijmteg.avif" type="image/png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

  <!-- Custom Styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/assistant_dashboard.css') }}">
</head>
<body>

<!-- Toggle Button (Always Visible) -->
<button id="toggleSidebar" class="btn btn-outline-primary position-fixed top-0 start-0 m-2" style="z-index: 1100;">
  <i class="bi bi-list fs-4"></i>
</button>

<!-- Sidebar -->
<!-- Sidebar -->
<div class="sidebar shadow" id="sidebar">
  <div class="text-center mt-5 mb-4">
    <img src="https://res.cloudinary.com/dl2ipzxyk/image/upload/v1751107241/logo_ijmteg.avif"
         alt="Company Logo"
         class="img-fluid logo-img"
         style="width: 120px; height: 120px; object-fit: contain;">
  </div>


  <a class="sidebar-link" data-url="/home">
    <i class="bi bi-speedometer2 me-2"></i>Dashboard
  </a>

  <!-- Clients Dropdown -->
  <div class="dropdown">
    <a class="sidebar-link dropdown-toggle" data-bs-toggle="collapse" href="#clientsMenu" role="button" aria-expanded="false">
      <i class="bi bi-people-fill me-2"></i>Clients
    </a>
    <div class="collapse" id="clientsMenu">
      <a class="sidebar-link ps-4" data-url="/admin/register_client_partial"><i class="bi bi-person-plus-fill me-2"></i>Register</a>
      <a class="sidebar-link ps-4" data-url="/client_list_partial"><i class="bi bi-card-list me-2"></i>View</a>
    </div>
  </div>

  <!-- Orders Dropdown -->
 <div class="dropdown">
  <a class="sidebar-link dropdown-toggle d-flex justify-content-between align-items-center"
     data-bs-toggle="collapse" href="#ordersMenu" role="button" aria-expanded="false">
    <span><i class="bi bi-bag-check-fill me-2"></i>Orders</span>
    {% if unapproved_orders_count > 0 %}
      <span class="badge bg-danger rounded-circle px-2 py-1">{{ unapproved_orders_count }}</span>
    {% endif %}
  </a>
  <div class="collapse" id="ordersMenu">
    <a class="sidebar-link d-flex justify-content-between align-items-center ps-4" data-url="/orders">
      <span><i class="bi bi-search me-2"></i>Review Orders</span>
      {% if unapproved_orders_count > 0 %}
        <span class="badge bg-danger rounded-circle px-2 py-1">{{ unapproved_orders_count }}</span>
      {% endif %}
    </a>
    <a class="sidebar-link ps-4" href="/approved_orders" target="_blank">
      <i class="bi bi-box-arrow-up-right me-2"></i>Approve Orders
    </a>
  </div>
</div>


  <a class="sidebar-link d-flex justify-content-between align-items-center" data-url="/payments">
  <span><i class="bi bi-cash-coin me-2"></i>Payments</span>
  {% if unconfirmed_payments_count > 0 %}
    <span class="badge bg-danger rounded-circle px-2 py-1">{{ unconfirmed_payments_count }}</span>
  {% endif %}
</a>

 <a class="sidebar-link d-flex justify-content-between align-items-center" data-url="/debtors">
  <span><i class="bi bi-graph-down-arrow me-2"></i>Debtors</span>
  {% if overdue_clients_count > 0 %}
    <span class="badge bg-danger rounded-circle px-2 py-1">{{ overdue_clients_count }}</span>
  {% endif %}
</a>

  <a class="sidebar-link" data-url="/bdc">
    <i class="bi bi-building me-2"></i>BDC Accounts
  </a>

 <a class="sidebar-link" data-url="/admin/settings">
    <i class="bi bi-gear-fill me-2"></i>Settings
  </a>
  
  <hr class="text-light mx-3" />
  <a class="sidebar-link" href="/logout">
    <i class="bi bi-box-arrow-right me-2"></i>Logout
  </a>
</div>

<!-- Main Content -->
<div class="main-content" id="main-content">
  <div class="topbar d-flex justify-content-between align-items-center">
    <h3 id="section-title">Loading...</h3>
    <div class="d-flex align-items-center">
      <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Admin Profile" class="rounded-circle me-2" style="width: 35px; height: 35px; object-fit: cover;">
      <strong>Admin.</strong>
    </div>
  </div>

  <div id="content-area">
    <div class="d-flex align-items-center text-muted">
      <div class="spinner-border text-secondary me-2" role="status" aria-hidden="true"></div>
      Loading content...
    </div>
  </div>
</div>

<!-- Sidebar Toggle Script -->
<script>
  // Toggle sidebar manually
  document.getElementById("toggleSidebar").addEventListener("click", function () {
    document.getElementById("sidebar").classList.toggle("collapsed");
    document.getElementById("main-content").classList.toggle("expanded");
  });

  // Collapse sidebar on link click (but not on dropdown toggles)
  const sidebarLinks = document.querySelectorAll(".sidebar a.sidebar-link");

  sidebarLinks.forEach(link => {
    link.addEventListener("click", function (e) {
      const isDropdownToggle = link.getAttribute("data-bs-toggle") === "collapse";

      if (!isDropdownToggle && window.innerWidth < 992) {
        document.getElementById("sidebar").classList.add("collapsed");
        document.getElementById("main-content").classList.add("expanded");
      }
    });
  });
</script>

<!-- Custom JS -->
<script src="{{ url_for('static', filename='js/admin_dashboard.js') }}"></script>
</body>
</html>
